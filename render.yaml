services:
  # Taiga Main Service
  - type: worker
    name: taiga
    env: docker
    dockerfilePath: ./Dockerfile
    plan: standard
    envVars:
      - key: RENDER_EXTERNAL_HOSTNAME
        fromService:
          name: taiga
          type: worker
          property: host
      - key: POSTGRES_HOST
        fromService:
          name: taiga-postgres
          type: pserv
          property: host
      - key: POSTGRES_PASSWORD
        sync: false
    
  # Postgres Database
  - type: pserv
    name: taiga-postgres
    env: docker
    repo: https://github.com/render-examples/postgres.git
    plan: standard
    envVars:
      - key: POSTGRES_USER
        value: taiga
      - key: POSTGRES_PASSWORD
        sync: false
      - key: POSTGRES_DB
        value: taiga
